<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>配置文件 | Ligg.EasyRPADesk</title>
    <meta name="description" content="无码化Windows应用编程快捷框架">
    <link rel="icon" href="/docs/favicon.ico">
    
    <link rel="preload" href="/docs/assets/css/0.styles.f9459e20.css" as="style"><link rel="preload" href="/docs/assets/js/app.f68432d0.js" as="script"><link rel="preload" href="/docs/assets/js/40.865f085b.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.bfccd756.js"><link rel="prefetch" href="/docs/assets/js/11.805f8409.js"><link rel="prefetch" href="/docs/assets/js/12.53ba6cd5.js"><link rel="prefetch" href="/docs/assets/js/13.d4182b60.js"><link rel="prefetch" href="/docs/assets/js/14.7fde2f0e.js"><link rel="prefetch" href="/docs/assets/js/15.a163097b.js"><link rel="prefetch" href="/docs/assets/js/16.b1d4d8b5.js"><link rel="prefetch" href="/docs/assets/js/17.54ab0aef.js"><link rel="prefetch" href="/docs/assets/js/18.14eac377.js"><link rel="prefetch" href="/docs/assets/js/19.5da4157a.js"><link rel="prefetch" href="/docs/assets/js/20.8f95e629.js"><link rel="prefetch" href="/docs/assets/js/21.1432df23.js"><link rel="prefetch" href="/docs/assets/js/22.447d0349.js"><link rel="prefetch" href="/docs/assets/js/23.cc9036d9.js"><link rel="prefetch" href="/docs/assets/js/24.e47bfdb8.js"><link rel="prefetch" href="/docs/assets/js/25.d296c0fd.js"><link rel="prefetch" href="/docs/assets/js/26.69a8d662.js"><link rel="prefetch" href="/docs/assets/js/27.218784c6.js"><link rel="prefetch" href="/docs/assets/js/28.bba2f719.js"><link rel="prefetch" href="/docs/assets/js/29.f24473a6.js"><link rel="prefetch" href="/docs/assets/js/3.57b04dd6.js"><link rel="prefetch" href="/docs/assets/js/30.8771f826.js"><link rel="prefetch" href="/docs/assets/js/31.e036f887.js"><link rel="prefetch" href="/docs/assets/js/32.aef3dfc1.js"><link rel="prefetch" href="/docs/assets/js/33.7d6d939f.js"><link rel="prefetch" href="/docs/assets/js/34.e627ed4e.js"><link rel="prefetch" href="/docs/assets/js/35.f49de5ea.js"><link rel="prefetch" href="/docs/assets/js/36.3317655d.js"><link rel="prefetch" href="/docs/assets/js/37.c0ff10f9.js"><link rel="prefetch" href="/docs/assets/js/38.93eb968a.js"><link rel="prefetch" href="/docs/assets/js/39.8b37ef18.js"><link rel="prefetch" href="/docs/assets/js/4.aedf4b72.js"><link rel="prefetch" href="/docs/assets/js/41.93bd7962.js"><link rel="prefetch" href="/docs/assets/js/42.88748bdf.js"><link rel="prefetch" href="/docs/assets/js/43.f744ba5c.js"><link rel="prefetch" href="/docs/assets/js/44.1bda399a.js"><link rel="prefetch" href="/docs/assets/js/45.6ec79a61.js"><link rel="prefetch" href="/docs/assets/js/46.5ca11f3e.js"><link rel="prefetch" href="/docs/assets/js/47.8c485644.js"><link rel="prefetch" href="/docs/assets/js/48.24dcf1d6.js"><link rel="prefetch" href="/docs/assets/js/49.1c8ceea2.js"><link rel="prefetch" href="/docs/assets/js/5.b561533f.js"><link rel="prefetch" href="/docs/assets/js/50.ce870619.js"><link rel="prefetch" href="/docs/assets/js/51.07119452.js"><link rel="prefetch" href="/docs/assets/js/6.81906c67.js"><link rel="prefetch" href="/docs/assets/js/7.4a325e26.js"><link rel="prefetch" href="/docs/assets/js/8.12f15d38.js"><link rel="prefetch" href="/docs/assets/js/9.d206a14c.js"><link rel="prefetch" href="/docs/assets/js/vendors~docsearch.e6e0ecc3.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.f9459e20.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">Ligg.EasyRPADesk</span></a> <div class="links" style="max-width:nullpx;"><form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/zh/" class="nav-link router-link-active">首页</a></div><div class="nav-item"><a href="/docs/zh/guide/" class="nav-link router-link-active">指南</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">示例</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>示例文档</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/zh/examples/ittk.html" class="nav-link">IT工具箱</a></li><li class="dropdown-subitem"><a href="/docs/zh/examples/devtk.html" class="nav-link">开发工具箱</a></li><li class="dropdown-subitem"><a href="/docs/zh/examples/orptk.html" class="nav-link">运维工具箱</a></li><li class="dropdown-subitem"><a href="/docs/zh/examples/ewc.html" class="nav-link">快捷Web客户端</a></li><li class="dropdown-subitem"><a href="/docs/zh/examples/ent-drive.html" class="nav-link">企业网盘</a></li><li class="dropdown-subitem"><a href="/docs/zh/examples/luck-draw.html" class="nav-link">幸运抽奖</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>关于</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/zh/about/repo.html" class="nav-link">仓库和文档</a></li><li class="dropdown-subitem"><a href="/docs/zh/about/contact-us.html" class="nav-link">联系我们</a></li><li class="dropdown-subitem"><a href="/docs/zh/about/history.html" class="nav-link">开发历史</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/zh/guide/introduction/config-file.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">简体中文</a></li><li class="dropdown-item"><!----> <a href="/docs/en/" class="nav-link">English</a></li></ul></div></div> <a href="https://github.com/Liggin2019/Ligg.EasyRPADesk" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/zh/" class="nav-link router-link-active">首页</a></div><div class="nav-item"><a href="/docs/zh/guide/" class="nav-link router-link-active">指南</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">示例</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>示例文档</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/zh/examples/ittk.html" class="nav-link">IT工具箱</a></li><li class="dropdown-subitem"><a href="/docs/zh/examples/devtk.html" class="nav-link">开发工具箱</a></li><li class="dropdown-subitem"><a href="/docs/zh/examples/orptk.html" class="nav-link">运维工具箱</a></li><li class="dropdown-subitem"><a href="/docs/zh/examples/ewc.html" class="nav-link">快捷Web客户端</a></li><li class="dropdown-subitem"><a href="/docs/zh/examples/ent-drive.html" class="nav-link">企业网盘</a></li><li class="dropdown-subitem"><a href="/docs/zh/examples/luck-draw.html" class="nav-link">幸运抽奖</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>关于</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/zh/about/repo.html" class="nav-link">仓库和文档</a></li><li class="dropdown-subitem"><a href="/docs/zh/about/contact-us.html" class="nav-link">联系我们</a></li><li class="dropdown-subitem"><a href="/docs/zh/about/history.html" class="nav-link">开发历史</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/zh/guide/introduction/config-file.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">简体中文</a></li><li class="dropdown-item"><!----> <a href="/docs/en/" class="nav-link">English</a></li></ul></div></div> <a href="https://github.com/Liggin2019/Ligg.EasyRPADesk" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <div class="load-success"><div id="codefund"></div></div> <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>整体介绍</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/docs/zh/guide/" aria-current="page" class="sidebar-link">总体介绍</a></li><li><a href="/docs/zh/guide/introduction/config-file.html" aria-current="page" class="active sidebar-link">配置文件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/guide/introduction/config-file.html#global级别配置文件" class="sidebar-link">Global级别配置文件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/guide/introduction/config-file.html#globalsetting" class="sidebar-link">GlobalSetting</a></li><li class="sidebar-sub-header"><a href="/docs/zh/guide/introduction/config-file.html#languages" class="sidebar-link">Languages</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/zh/guide/introduction/config-file.html#app级别配置文件" class="sidebar-link">App级别配置文件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/zh/guide/introduction/config-file.html#applicationsetting" class="sidebar-link">ApplicationSetting</a></li><li class="sidebar-sub-header"><a href="/docs/zh/guide/introduction/config-file.html#多语言文本配置文件" class="sidebar-link">多语言文本配置文件</a></li><li class="sidebar-sub-header"><a href="/docs/zh/guide/introduction/config-file.html#ui配置文件" class="sidebar-link">UI配置文件</a></li></ul></li></ul></li><li><a href="/docs/zh/guide/introduction/expression.html" class="sidebar-link">Expression</a></li><li><a href="/docs/zh/guide/introduction/shell.html" class="sidebar-link">Shell</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>教程-Winform</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/docs/zh/guide/tutorials/winform/overall.html" class="sidebar-link">整体说明</a></li><li><a href="/docs/zh/guide/tutorials/winform/quick-start.html" class="sidebar-link">快速开始</a></li><li><a href="/docs/zh/guide/tutorials/winform/subjects.html" class="sidebar-link">专题</a></li><li><a href="/docs/zh/guide/tutorials/winform/form.html" class="sidebar-link">Form</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>教程-Console</span> <!----></p> <ul class="sidebar-group-items"></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>附录</span> <!----></p> <ul class="sidebar-group-items"></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/docs/zh/guide/other/faq.html" class="sidebar-link">常见问题</a></li><li><a href="/docs/zh/guide/other/discuss.html" class="sidebar-link">讨论组</a></li><li><a href="/docs/zh/guide/other/release-notes.html" class="sidebar-link">Release Notes</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="配置文件"><a href="#配置文件" class="header-anchor">#</a> 配置文件</h1> <div class="tip custom-block"><p class="custom-block-title">提示</p> <ul><li>配置文件支持.xlsx、.csv、.xml、.json格式; 在开发阶段系统查找的数据文件格式顺序是: .xlsx、.csv、.xml、.json, 在发行阶段系统查找的数据文件格式顺序是: .json、.xml、.csv、xlsx。你可以使用你习惯的配置文件, 也可以多种格式的配置文件并存。</li> <li>建议开发阶段采用.csv的配置文件(读取.xlsx较慢, 可用任意文件名的.xlsx设计完成后, 转存为.csv文件; 发行阶段统一采用.json的配置文件, 删除其他格式的配置文件。</li> <li>在配置文件的公式里或Ligg Shell里使用配置文件路径, 可以不写后缀(建议), 如果写后缀的话就会精确查找该格式的配置文件。</li> <li>配置数据类型分为Entity/Table; 如果以.xlsx、.csv作为配置文件, 表达Entity/Table格式的数据, 样式有所不同; 表达Entity的2列多行, 表头必须是FieldName&amp;FiledValue, 示例见<a href="#Global%E7%BA%A7%E5%88%AB%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">GlobalSetting</a>; 表达Table的多列多行, 示例见<a href="#Global%E7%BA%A7%E5%88%AB%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">Languages</a>。</li> <li>使用.xlsx、.csv格式作为配置文件, 对于文件路径的反斜杠要写为\\。</li> <li>使用.csv、.xml、.json格式的作为配置文件, 建议都保存为Utf-8格式, 否则容易导致汉字乱码;</li> <li>配置文件分为Global级别和Application级别, 框架下可以容纳多个Application, 如IT运维工具箱(code: OrpTk)、IT开发工具箱(code: DevTk)、企业网盘(code: EntDrv)等, 各Application的配置放在相应的App-x下, 见<a href="/docs/zh/guide/#运行目录">整体介绍-运行目录</a>。</li></ul></div> <h2 id="global级别配置文件"><a href="#global级别配置文件" class="header-anchor">#</a> Global级别配置文件</h2> <h3 id="globalsetting"><a href="#globalsetting" class="header-anchor">#</a> GlobalSetting</h3> <p><strong>path</strong>: \Conf\GlobalSetting.*, Entity格式, 必须存在</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">namespace</span> <span class="token namespace">Ligg<span class="token punctuation">.</span>EasyRPADesk</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GlobalSetting</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> DefaultCulture <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> HelpdeskEmail <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> PhythonExePath <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>.xls、.csv配置文件的样式</strong>：<br></p> <table><thead><tr><th>FieldName</th> <th>FieldValue</th></tr></thead> <tbody><tr><td>DefaultCulture</td> <td>en-US</td></tr> <tr><td>HelpdeskEmail</td> <td>LiggHelpdesk@outlook.com</td></tr> <tr><td>PhythonExePath</td> <td>C:\\Python38\\Python.exe</td></tr></tbody></table> <p><strong>示例</strong>：<br></p> <table><thead><tr><th>字段</th> <th>DefaultCulture</th> <th>HelpdeskEmail</th> <th>PhythonExePath</th></tr></thead> <tbody><tr><td>示例1</td> <td>en-US</td> <td>LiggHelpdesk@outlook.com</td> <td>C:\Python38\Python.exe</td></tr> <tr><td>示例2</td> <td>zh-CN</td> <td>LiggHelpdesk@outlook.com</td> <td>\Python.exe</td></tr> <tr><td>示例3</td> <td>zh-CN</td> <td></td> <td></td></tr></tbody></table> <p><strong>示例说明</strong>：<br> <strong>DefaultCulture:</strong> 不可为空; 程序默认的起始Culture; 必需遵循标准, 否则程序启动时会报错。在配置文件\Conf\Apps\App-x\ApplicationSetting.<em>中有对应的设置, 如为空则取此处的值。<br> <strong>HelpdeskEmail:</strong> 不可为空; 作用： 程序运行出错，弹出错误提示时，提醒用户给该帐号发邮件; 如空, 则没有发邮件的提示。在配置文件\Conf\Apps\App-x\ApplicationSetting.</em> 中有对应的设置, 如为空则取此处的值。<br> <strong>PhythonExePath:</strong> 可为空;  支持绝对和相对路径, 如果是相对路径, 则父路径为@rootDir\Lib。在配置文件\Conf\Apps\App-x\ApplicationSetting.*中有对应的设置, 如为空则取此处的值。如都为空, 执行RunPython时会有出错提示。<br></p> <blockquote><p><strong>如果使用.xlsx、.csv格式, 对于文件路径的反斜杠要写为\\</strong> <br> <strong>相对路径的第一个反斜杠可省略</strong></p></blockquote> <hr> <h3 id="languages"><a href="#languages" class="header-anchor">#</a> Languages</h3> <p><strong>path</strong>: \Conf\Language\Languages.*, Table格式; 如不需要支持多语言, 无需此配置文件; 如需要支持多语言, 必需此配置文件, 如无, 系统启动时报错。</p> <p><strong>.xls、.csv配置文件的样式</strong>：<br></p> <table><thead><tr><th>CultureName</th> <th>LanguageCode</th> <th>LanguageName</th> <th>ImageUrl</th></tr></thead> <tbody><tr><td>en-US</td> <td>en</td> <td>English</td> <td>\\Images\\us.png</td></tr> <tr><td>zh-CN</td> <td>miao</td> <td>Miao(苗语)</td> <td>Images\cn.png</td></tr> <tr><td>zh-CN</td> <td>szh</td> <td>简体中文</td> <td>Images\\cn.png</td></tr> <tr><td>zh-CN</td> <td>czh</td> <td>繁体中文</td> <td>Images\\cn.png</td></tr> <tr><td>zh-HK</td> <td>czh</td> <td>繁体中文</td> <td>Images\\cn.png</td></tr> <tr><td>de-DE</td> <td>de</td> <td>Deutsch</td> <td>Images\\de.png</td></tr></tbody></table> <p><strong>示例说明</strong>：<br> <strong>CultureName:</strong> 不可为空; 为空, 则启动程序时报错; 必需遵循标准, 否则程序启动时会报错。详见<a href>附录-CultureName列表</a>, <a href>教程-Winform-多语言支持</a><br> <strong>LanguageCode:</strong> 不可为空; 为空, 则程序启动时报错。<br> <strong>LanguageName:</strong> 不可为空; 为空, 则界面语言切换栏文字显示空白。<br> <strong>ImageUrl:</strong> 不可为空; 为空, 则界面语言切换栏图片显示空白; 只支持相对路径, 父路径: @rootDir\Conf\Cultures\images\。<br></p> <blockquote><p><strong>上述示例可同时存在, 前提是CultureName+LanguageCode不重复</strong> <br> <strong>使用.xlsx、.csv格式, 对于文件路径的反斜杠要写为\\</strong> <br> <strong>相对路径的第一个反斜杠可省略</strong></p></blockquote> <div class="warning custom-block"><p class="custom-block-title">注意</p> <ul><li>系统UI上输出数值、日期格式按当前Culture显示。代码如下:</li></ul> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> singleOutputStr <span class="token operator">=</span> <span class="token number">3.14f</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> timeOutputStr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DateTime</span><span class="token punctuation">(</span><span class="token number">2021</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToShortDateString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>配置文件里输入的文本转数值或时间时，没有考虑Culture, 请按en-US的标准书写。代码如下:</li></ul> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> singleInput<span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToSingle</span><span class="token punctuation">(</span>inputStr<span class="token punctuation">,</span> CultureInfo<span class="token punctuation">.</span>InvariantCulture<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> timeInput <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToDateTime</span><span class="token punctuation">(</span>inputStr<span class="token punctuation">,</span> CultureInfo<span class="token punctuation">.</span>InvariantCulture<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <hr> <h2 id="app级别配置文件"><a href="#app级别配置文件" class="header-anchor">#</a> App级别配置文件</h2> <h3 id="applicationsetting"><a href="#applicationsetting" class="header-anchor">#</a> ApplicationSetting</h3> <p><strong>path</strong>: \Conf\Apps\App-x\ApplicationSetting.*, Entity格式, 必须存在</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">namespace</span> <span class="token namespace">Ligg<span class="token punctuation">.</span>EasyRPADesk</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationSetting</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//可为empty, 如果empty, 从GlobalSetting获取</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> PhythonExecPath <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token comment">//可为empty, 如果empty, 从GlobalSetting获取</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> HelpdeskEmail <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token comment">//不能为null</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> SupportMultiLanguages <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token comment">//起始Culture</span>
        <span class="token comment">//如果为empty, 则从配置文件\Conf\Language\Languages* 的CultureName获取</span>
        <span class="token comment">//如果SupportMultiLanguages为true, </span>
        <span class="token comment">//必须与则从配置文件\Conf\Language\Languages* 的CultureName保持一致</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> DefaultCulture <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token comment">//起始LanguageCode, 不能为empty, 否则系统启动报错</span>
        <span class="token comment">//如SupportMultiLanguages为true,</span>
        <span class="token comment">//必须与则从配置文件\Conf\Language\Languages* 的LangugeCode保持一致</span>
        <span class="token comment">//如SupportMultiLanguages为false</span>
        <span class="token comment">//必须与AbbrevAnnexes/ApplicationAnnexes等配置文件的LanguageCode保持一致</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> DefaultLanguage <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token comment">//Application界面语言切换栏显示的语言列表</span>
        <span class="token comment">//示例: zh-CN:en, zh-CN:szh, en-US:en</span>
        <span class="token comment">//格式: 以':' ','相隔; ':' 2侧不能有空格</span>
        <span class="token comment">//必须与则从配置文件\Conf\Language\Languages* 保持一致</span>
        <span class="token comment">//如SupportMultiLanguages为false, 此配置无效</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> IncludedLanguages <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token comment">//可为empty, 不能为empty, 否则会导致AutoUpgrade功能出错</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> ApplicationVersion <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

       <span class="token comment">//不能为null</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> HasCblpComponent <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token comment">//支持绝对路径和相对路径</span>
        <span class="token comment">//如果是相对路径, 父路径是 @rootDir\\Cblps\\App-x   </span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> CblpDllPath <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token comment">//可为empty, 如果empty, 获取 @appDataDir 失败</span>
        <span class="token comment">//支持绝对路径和相对路径</span>
        <span class="token comment">//如果是相对路径, 父路径是 @rootDir\\Data\\App-x   </span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> ApplicationDataDir <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token comment">//可为empty, 如果empty, 获取 @appLibDir 失败</span>
        <span class="token comment">//支持绝对路径和相对路径</span>
        <span class="token comment">//如果是相对路径, 父路径是 @rootLibDir\\Lib\\App-x   </span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> ApplicationLibDir <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token comment">//可为empty, 如果empty, 缺省是最后一个硬盘的\\tmp\\%appCode%</span>
        <span class="token comment">//只支持绝对路径</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> ApplicationTempDir <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token comment">//不能为null, 如果为true, </span>
        <span class="token comment">//如果启始参数里不带startPassword,则程序启动时弹出密码验证界面，显式验证, </span>
        <span class="token comment">//如果启始参数里带有Password, 首先隐式验证，通过验证, 程序继续; 否则开始显式验证</span>
        <span class="token comment">//启始Form下的StartPolicy配置文件你也有对应配置, 优先级此处为高, </span>
        <span class="token comment">//即 ApplicationSetting.VerifyPasswordAtStart=</span>
        <span class="token comment">//ApplicationSetting.VerifyPasswordAtStart||FormStartPolicy.VerifyPasswordAtStart</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> VerifyPasswordAtStart <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token comment">//Ldict 格式,例如</span>
        <span class="token comment">//Params:HappyCoding</span>
        <span class="token comment">//上例表示 显式验证时, 输入HappyCoding, 可通过验证</span>
        <span class="token comment">//上例表示 隐式验证时, 起始参数的startPassword需要写HappyCoding, 才可通过验证</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> PasswordVerificationRule <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token comment">//不能为null, 如果为true, 则程序启动时登录验证对话框, 通过验证, 程序继续</span>
        <span class="token comment">//启始Form下也有对应配置, 优先级此处为高, </span>
        <span class="token comment">//即 ApplicationSetting.LogonAtStart=</span>
        <span class="token comment">//ApplicationSetting.LogonAtStart||StartForm.LogonAtStart</span>
        <span class="token comment">//对Winform, 登录界面的UI配置路径: %appZonesDir%\.Logon\</span>
        <span class="token comment">//对Console, 登录界面的UI配置路径: %appScenariosDir%\.Logon\</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> LogonAtStart <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong>：<br></p> <ul><li>PasswordVerificationRule 的数据格式为Ldict， 详见 <a href="/docs/zh/guide/introduction/expression.html#Ldict">数据格式-Ldict</a>, 具体示例详见 <a href>教程-Winform-专题-起始密码</a> <a href>教程-Console-专题-起始密码</a></li> <li><a href="/docs/zh/guide/#程序运行">起始参数也包含起始语言</a>, 起始语言的优先级是: 语言起始参数&gt;ApplicationSetting的起始语言配置 , 详见 <a href>教程-Console-多语言支持</a> <a href>教程-Winform-多语言支持</a></li></ul> <hr> <h3 id="多语言文本配置文件"><a href="#多语言文本配置文件" class="header-anchor">#</a> 多语言文本配置文件</h3> <ul><li><strong>path</strong>: \Conf\Apps\App-x\ApplicationAnnexes.*, 可无; 是本应用的名称、描述、备注等属性的多语言配置文件</li> <li><strong>path</strong>: \Conf\Apps\App-x\SharedAnnexes.*, Table格式, 可无; 应用内共用的语言配置文件, 常用于未定义文本的公共UI元素的后绑定文本。</li></ul> <div class="tip custom-block"><p class="custom-block-title">注意</p> <ul><li>如果不需要多语言支持, SharedAnnexes, 但是需要规范一些句子的输出, 也可使用SharedAnnexes。</li> <li>虽然不需要多语言支持, 但在应用里要调用本Application的一些名称、描述、备注等, 可以使用ApplicationAnnexes。</li></ul></div> <p><strong>SharedAnnexes 示例</strong>：<br></p> <table><thead><tr><th>字段</th> <th>MasterName</th> <th>DisplayName</th> <th>Description</th> <th>Remark</th> <th>LangugageCode</th></tr></thead> <tbody><tr><td>示例1</td> <td>This function is under developing...</td> <td>本功能正在开发当中...</td> <td></td> <td></td> <td>szh</td></tr> <tr><td>示例1</td> <td>This function is under developing...</td> <td>本功能正在開發當中…</td> <td></td> <td></td> <td>czh</td></tr> <tr><td>示例1</td> <td>This function is under developing...</td> <td>Diese Funktion entwickelt sich...</td> <td></td> <td></td> <td>de</td></tr> <tr><td>示例2</td> <td>Connecting server failed...</td> <td>服務器連接失敗…</td> <td></td> <td></td> <td>szh</td></tr> <tr><td>示例2</td> <td>Connecting server failed...</td> <td>架構</td> <td></td> <td></td> <td>czh</td></tr> <tr><td>示例2</td> <td>Connecting server failed...</td> <td>Verbindung des Servers fehlgeschlagen...</td> <td></td> <td></td> <td>de</td></tr></tbody></table> <p><strong>ApplicationAnnexes 示例</strong>：<br></p> <table><thead><tr><th>字段</th> <th>DisplayName</th> <th>Description</th> <th>Remark</th> <th>Remark1</th> <th>Remark2</th> <th>LangugageCode</th></tr></thead> <tbody><tr><td>示例1</td> <td>IT运维工具箱</td> <td>IT服务管理和运维自动化系统</td> <td>运维中心</td> <td>ITSMAOA</td> <td>打造高效、精准、可测量的IT服务和运维管理</td> <td>szh</td></tr> <tr><td>示例1</td> <td>IT Operation Tookit</td> <td>IT Service Management And Operation Automation System</td> <td>Operation Center</td> <td>ITSMAOA</td> <td>Build easy, precise, metrizable IT service and operation</td> <td>en</td></tr></tbody></table> <p><strong>说明</strong>：<br></p> <ul><li><p>ApplicationAnnexes并不需要MasterName字段, 系统会自动加上去。</p></li> <li><p>在配置文件的公式里可以这样调用PhraseAnnexes的当前语言的文本：</p> <ul><li>缺省是DisplayName, 可以省略
<ul><li>=GetSharedAnnexText; This function is under developing...</li></ul></li> <li>不省略的写法
<ul><li>=GetSharedAnnexText; This function is under developing...; DispayName</li> <li>=GetSharedAnnexText; This function is under developing...; Discription</li></ul></li></ul></li> <li><p>在配置文件的公式里可以这样调用ApplicationAnnexes 的当前语言的文本：</p> <ul><li>缺省是DisplayName, 可以省略
<ul><li>=GetApplicationAnnexText</li></ul></li> <li>不省略的写法
<ul><li>=GetApplicationAnnexText; DispayName</li> <li>=GetApplicationAnnexText; Remark2</li></ul></li></ul></li></ul> <hr> <h3 id="ui配置文件"><a href="#ui配置文件" class="header-anchor">#</a> UI配置文件</h3> <ul><li>每个Application可以有多个Console的应用窗口, 每个应用窗口就是一个Scenario, 比如IT运维工具箱(OrpTk)有2个Scenario: RunShell、RunPython; 他们的UI配置文件就分别放到
<ul><li>\Conf\Apps\OrpTk\UI\Console\Scenarios\Basic\RunShell</li> <li>\Conf\Apps\OrpTk\UI\Console\Scenarios\Basic\RunPython</li></ul></li> <li>每个Application可以有多个Winform的启动Form, 比如OrpTk有4个 不同类型的Form分别是: 管理员主界面(Function Form)、用户主界面(Function Form)、巡检工具Svi界面(Single View Interface, Svi Form)、备份作业工具Szi界面(Single Zone Interface, SziForm), 他们的UI配置目录就分别放到
<ul><li>\Conf\Apps\OrpTk\UI\Functions\Admin</li> <li>\Conf\Apps\OrpTk\UI\Functions\User</li> <li>\Conf\Apps\OrpTk\UI\Views\Insp</li> <li>\Conf\Apps\OrpTk\UI\Zones\Common\BakWorker</li></ul></li></ul> <blockquote><ul><li>注意Function Form的路径是单层的</li> <li>UI配置详见<em>教程相关内容</em>。</li></ul></blockquote></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/Liggin2019/Ligg.EasyRPADesk/docs/edit/master/docs/zh/guide/introduction/config-file.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/docs/zh/guide/" class="prev router-link-active">
          总体介绍
        </a></span> <span class="next"><a href="/docs/zh/guide/introduction/expression.html">
          Expression
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/docs/assets/js/app.f68432d0.js" defer></script><script src="/docs/assets/js/40.865f085b.js" defer></script>
  </body>
</html>
